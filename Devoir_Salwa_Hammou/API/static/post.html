<script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
<div id="app"></div>
<script type="text/babel" data-presets="react" data-type="module">
  import React from "https://esm.sh/react@18";
  import ReactDOM from "https://esm.sh/react-dom@18";

  function Post() {
    const [article, setArticle] = React.useState(); 

    //fonction pour recuperer l'article en fonction de son ID (son numéro d'ordre dans le backend)
    async function fetchArticle_with_ID(articleId) {
      const res = await fetch(`/articles/${articleId}`); //on récupère l'article en fonction de son ID dans le backend
      //si l'article a bien été récupéré, on le transforme en json
      if (res.ok) {
        const json = await res.json();
        setArticle(json);
      } else {
        console.error("L'article n'a pas pu être affiché");
      }
    }

    //
    React.useEffect(() => {
      const urlParams = new URLSearchParams(window.location.search);//window.location.search = partie de l'URL qui se trouve après le point d'intérrogation (donc, dans notre cas sera articleId = n°)
      const articleId = urlParams.get("articleId"); //on récupère l'id uniquement
      //on appelle la fonction fecthArticle_with_ID pour recuper donnees
      fetchArticle_with_ID(articleId);
      
    }, []);

    //affichage de l'article: obligé de mettre "article ?" pour permettre l'affichage de l'article que lorsque la variable "article" contient des donnees sinon on a un problème et rien ne s'affiche si je clic sur l'article 
    return (
      <div>
        {article ? (
          <div>
            <h1>{article.title}</h1>
            <p>{article.content}</p>
          </div>
        ) : (
          <p>en attente qu'un article soit selectionne</p>
        )}
      </div>
    );
  }

  const appContainer = document.getElementById("app");
  ReactDOM.createRoot(appContainer).render(<Post />);
</script>